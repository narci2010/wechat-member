/*
 * wechat-member v1.0.0 (https://github.com/dengliran/wechat-member)
 * Designed and developed by dengliran
 */
$(function(){function setPM(){for(var n={},t=$('script[type="text/html"][id*="tpl_"]').not(".dialog"),a=0;a<t.length;a++){var e=t[a],i=e.id.replace(/tpl_/,"");n[i]={name:i,url:"#"+i,template:"#"+e.id}}n.home.url="#";for(var o in n)PMer.push(n[o]);PMer.setDefault("home").init()}var PMer={$container:$(".wm-container"),_configs:[],_pageStack:[],_defaultPage:null,_pageIndex:1,setDefault:function(n){return this._defaultPage=this._find("name",n),this},push:function(n){return this._configs.push(n),this},init:function(){var n=this;$(window).on("hashchange",function(){var t=history.state||{},a=0===location.hash.indexOf("#")?location.hash:"#",e=n._find("url",a)||n._defaultPage;t._pageIndex<n._pageIndex||n._findInStack(a)?n._back(e):n._go(e)}),history.state&&history.state._pageIndex&&(this._pageIndex=history.state._pageIndex),this._pageIndex--;var t=0===location.hash.indexOf("#")?location.hash:"#",a=n._find("url",t)||n._defaultPage;return this._go(a),this},_go:function(n){this._pageIndex++,history.replaceState&&history.replaceState({_pageIndex:this._pageIndex},"",location.href);var t=$(n.template).html(),a=$(t).addClass(n.name+" slideIn");a.on("animationend webkitAnimationEnd",function(){a.removeClass("slideIn")}),this.$container.append(a);var e=this._pageStack[this._pageStack.length-1]||{};try{e.dom.addClass("slideGo").on("animationend webkitAnimationEnd",function(){e.dom.off("animationend webkitAnimationEnd").removeClass("slideGo").remove()})}catch(n){}this._pageStack.push({config:n,dom:a}),this.pageReady(n.name),console.warn("go")},_back:function(n){this._pageIndex--;var t=this._pageStack.pop(),a=0===location.hash.indexOf("#")?location.hash:"#";if(this._findInStack(a)){var e=this._pageStack[this._pageStack.length-1];this.$container.prepend(e.dom),e.dom.addClass("slideBack").on("animationend webkitAnimationEnd",function(){e.dom.removeClass("slideBack")}),this.pageReady(n.name)}else{var i=$(n.template).html(),o=$(i).addClass(n.name);this.$container.prepend(o),this._pageStack.push({config:n,dom:o}),this.pageReady(n.name)}$(".fullpage").remove(),t.dom.addClass("slideOut").on("animationend webkitAnimationEnd",function(){t.dom.remove()}),console.warn("back")},_findInStack:function(n){for(var t=null,a=0;a<this._pageStack.length;a++){var e=this._pageStack[a];if(e.config.url===n){t=e;break}}return t},_find:function(n,t){for(var a=null,e=0;e<this._configs.length;e++)if(this._configs[e][n]===t){a=this._configs[e];break}return a},pageReady:function(name){var ob;try{ob=eval(name)}catch(n){}for(var k in ob)"function"!=typeof ob[k]&&"[object Function]"!==Object.prototype.toString.call(ob[k])||!ob.hasOwnProperty(k)||"_"!==k[0]&&ob[k]()}};setPM()});
//# sourceMappingURL=wm.min.js.map
